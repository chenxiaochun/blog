<img src="./git-state.svg">

在 git 中，有几个基础概念是需要大家深刻理解的。否则，实际使用过程中，就会容易让人搞糊涂

上图中，左侧被称为工作区，右侧被称为版本库

工作区很容易理解，就是我们日常修改文件，但还未执行任何提交动作时的区域

右侧的版本库分为三个区域。标记为 index 的区域是暂存区。标记为 master 的是 master 分支所代表的目录树。标记为 objects 的为 git 对象

暂存区实际存在于当前工程的`.git/index`目录下，是一个文件索引的目录树，像是一个虚拟的工作区，记录了文件名和文件的状态信息。而文件内容则保存在`.git/objects`目录下，它是 git 的对象库。在上图中，就是 objects 标识的位置

HEAD 表示一个游标，此时指向的是 master 分支。所以，在 git 命令中经常可以用 HEAD 和 master 互相替换

当在工作中区执行`git add`命令时，暂存区的文件树会被更新。同时会在对象库中写入一个新对象，然后会把对象的 ID 记录在暂存区的文件索引中

当执行`git commit`命令时，暂存区的文件树就会写入到版本库中。master 也会自动指向最新的目录树

当执行`git reset HEAD`命令时，暂存区会被 master 分支所指向的文件树替换掉。但是不会影响当前工作区

当`git rm --cached <file>`或者`git reset <file>`命令时，会从暂存区中删除指定的文件，不会影响当前工作区

当执行`git checkout`或者`git checkout -- <file>`命令时，会用暂存区的全部或者指定文件替换当前工作区的文件。此命令比较危险，使用时一定要慎重

当执行`git checkout HEAD`或者`git checkout HEAD <file>`命令时，会用 HEAD 游标指向的全部或者指定文件替换当前工作区的文件。此命令也很危险，请慎重使用